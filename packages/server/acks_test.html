<!DOCTYPE html>
<!--
 Copyright 2023 Red Hat, Inc

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
-->

<html>
<head>
<title>acks_test.go</title>
<meta charset="utf-8"/>
<style type="text/css">body {
    background: rgb(225, 225, 225);
    margin: 0px;
    padding: 0px;
}

#docgo p {
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 15px;
    margin-left: 0px;
}

#docgo div {
    display: inline;
}

#docgo #background {
    position: fixed;
    top: 0; left: 525px; right: 0; bottom: 0;
    background: rgb(47, 47, 47);
    border-left: 1px solid #e5e5ee;
    z-index: -1;
}

#docgo .keyword {
    color: rgb(250, 200, 100);
}

#docgo .literal {
    color: rgb(140, 190, 100);
}

#docgo .ident {
    color: white;
}

#docgo .operator {
    color: white;
}

#docgo .comment {
}

#docgo h1, h2, h3, h4, h5 {
    text-align: left;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 15px;
    margin-left: 0px;
}

#docgo h1 {
    margin-top: 40px;
}

#docgo .doc {
    vertical-align: top;
    font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, FreeSerif, serif;
    font-size: 15px;
    line-height: 22px;
    color: black;
    min-width: 450px;
    max-width: 450px;
    padding-top: 10px;
    padding-right: 25px;
    padding-bottom: 1px;
    padding-left: 50px;
    overflow-x: hidden;
}

#docgo .code {
    min-width: 650px;
    max-width: 650px;
    padding-left: 25px;
    padding-right: 15px;
    border-left: 1px;
    overflow-x: hidden;
    vertical-align: top;
}

#docgo .code pre code  {
    font-size: 12px;
    line-height: 18px;
    font-family: Menlo, Monaco, Consolas, "Lucida Console", monospace;
    color: rgb(120, 120, 120);
}
</style>
</head>
<body>
<div id="docgo">
  <div id="background"></div>
  <table>
    <thead><tr><th class="doc"><h1>acks_test.go</h1></th><th class="code"></th></tr></thead>
    <tbody>
      
      <tr class="section">
	<td class="doc"><p>Copyright 2023 Red Hat, Inc</p>

<p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>

<pre><code> http://www.apache.org/licenses/LICENSE-2.0
</code></pre>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
</td>
	<td class="code"><pre><code></code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>deleteAcknowledge</p>
</td>
	<td class="code"><pre><code>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>generateRuleAckMap</p>
</td>
	<td class="code"><pre><code>
<div class="keyword">package</div> <div class="ident">server_test</div><div class="operator"></div>

<div class="keyword">import</div> <div class="operator">(</div>
	<div class="literal">&#34;fmt&#34;</div><div class="operator"></div>
	<div class="literal">&#34;net/http&#34;</div><div class="operator"></div>
	<div class="literal">&#34;testing&#34;</div><div class="operator"></div>
	<div class="literal">&#34;time&#34;</div><div class="operator"></div>

	<div class="literal">&#34;github.com/RedHatInsights/insights-results-aggregator-data/testdata&#34;</div><div class="operator"></div>
	<div class="ident">ira_server</div> <div class="literal">&#34;github.com/RedHatInsights/insights-results-aggregator/server&#34;</div><div class="operator"></div>
	<div class="literal">&#34;github.com/stretchr/testify/assert&#34;</div><div class="operator"></div>

	<div class="literal">&#34;github.com/RedHatInsights/insights-results-smart-proxy/content&#34;</div><div class="operator"></div>
	<div class="literal">&#34;github.com/RedHatInsights/insights-results-smart-proxy/server&#34;</div><div class="operator"></div>
	<div class="literal">&#34;github.com/RedHatInsights/insights-results-smart-proxy/tests/helpers&#34;</div><div class="operator"></div>
<div class="operator">)</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestReadAckListNoResult</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRulesAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRules&#34;:[],
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ListOfDisabledRulesSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRulesAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackListResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;data&#34;:[],
		&#34;meta&#34;: {
			&#34;count&#34;: 0
		}
	}
	`</div><div class="operator"></div>
	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckListEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackListResponse</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestReadAckList1Result</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRulesAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRules&#34;:[
			{
				&#34;rule_id&#34;: &#34;%v&#34;,
				&#34;error_key&#34;: &#34;%v&#34;,
				&#34;justification&#34;: &#34;%v&#34;,
				&#34;created_at&#34;: {
					&#34;Time&#34;: &#34;%v&#34;,
					&#34;Valid&#34;: true
				},
				&#34;updated_at&#34;: {
					&#34;Time&#34;: &#34;%v&#34;,
					&#34;Valid&#34;: true
				}
			}
		],
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRulesAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div>
		<div class="ident">ackedRulesAggregatorResponse</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>
	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ListOfDisabledRulesSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRulesAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackListResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;data&#34;:[
			{
				&#34;rule&#34;: &#34;%v&#34;,
				&#34;justification&#34;: &#34;%v&#34;,
				&#34;created_by&#34;: &#34;&#34;,
				&#34;created_at&#34;: &#34;%v&#34;,
				&#34;updated_at&#34;: &#34;%v&#34;
			}
		],
		&#34;meta&#34;: {
			&#34;count&#34;: 1
		}
	}
	`</div><div class="operator"></div>
	<div class="ident">ackListResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackListResponse</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckListEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackListResponse</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestReadAckList2Results</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>
	<div class="ident">justificationNote2</div> <div class="operator">:=</div> <div class="literal">&#34;different justification&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRulesAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRules&#34;:[
			{
				&#34;rule_id&#34;: &#34;%v&#34;,
				&#34;error_key&#34;: &#34;%v&#34;,
				&#34;justification&#34;: &#34;%v&#34;,
				&#34;created_at&#34;: {
					&#34;Time&#34;: &#34;%v&#34;,
					&#34;Valid&#34;: true
				},
				&#34;updated_at&#34;: {
					&#34;Time&#34;: &#34;%v&#34;,
					&#34;Valid&#34;: true
				}
			},
			{
				&#34;rule_id&#34;: &#34;%v&#34;,
				&#34;error_key&#34;: &#34;%v&#34;,
				&#34;justification&#34;: &#34;%v&#34;,
				&#34;created_at&#34;: {
					&#34;Time&#34;: &#34;%v&#34;,
					&#34;Valid&#34;: true
				},
				&#34;updated_at&#34;: {
					&#34;Time&#34;: &#34;%v&#34;,
					&#34;Valid&#34;: true
				}
			}
		],
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRulesAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRulesAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>2nd entry</p>
</td>
	<td class="code"><pre><code>		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule2ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey2</div><div class="operator">,</div> <div class="ident">justificationNote2</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>
	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ListOfDisabledRulesSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRulesAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackListResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;data&#34;:[
			{
				&#34;rule&#34;: &#34;%v&#34;,
				&#34;justification&#34;: &#34;%v&#34;,
				&#34;created_by&#34;: &#34;&#34;,
				&#34;created_at&#34;: &#34;%v&#34;,
				&#34;updated_at&#34;: &#34;%v&#34;
			},
			{
				&#34;rule&#34;: &#34;%v&#34;,
				&#34;justification&#34;: &#34;%v&#34;,
				&#34;created_by&#34;: &#34;&#34;,
				&#34;created_at&#34;: &#34;%v&#34;,
				&#34;updated_at&#34;: &#34;%v&#34;
			}
		],
		&#34;meta&#34;: {
			&#34;count&#34;: 2
		}
	}
	`</div><div class="operator"></div>
	<div class="ident">ackListResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackListResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule2CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote2</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckListEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div>  <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>        <div class="ident">ackListResponse</div><div class="operator">,</div>
		<div class="ident">BodyChecker</div><div class="operator">:</div> <div class="ident">ackInResponseChecker</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestReadAckListInvalidToken</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRulesAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRules&#34;:[],
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ListOfDisabledRulesSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRulesAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackListResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;status&#34;: &#34;Malformed authentication token&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckListEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">badJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusForbidden</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackListResponse</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestReadAckListAggregatorError</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ListOfDisabledRulesSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckListEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestReadAckListUnparsableAggregatorJSON</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ListOfDisabledRulesSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="literal">&#34;{invalid json body&#34;</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckListEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>also 500, but testing different condition</p>
</td>
	<td class="code"><pre><code>		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestGetAcknowledgeNotFound</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusNotFound</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckGetEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusNotFound</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestGetAcknowledgeAggregatorError</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckGetEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestGetAcknowledgeUnparsableAggregatorJSON</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="literal">&#34;{invalid json body&#34;</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckGetEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>also 500, but testing different condition</p>
</td>
	<td class="code"><pre><code>		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestGetAcknowledgeFound</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">expectedResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule&#34;: &#34;%v&#34;,
		&#34;justification&#34;: &#34;%v&#34;,
		&#34;created_by&#34;: &#34;&#34;,
		&#34;created_at&#34;: &#34;%v&#34;,
		&#34;updated_at&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">expectedResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">expectedResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckGetEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">expectedResponse</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestGetAcknowledgeInvalidRuleIDBadRequest</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckGetEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>invalid composite rule ID</p>
</td>
	<td class="code"><pre><code>		<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">}</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusBadRequest</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestGetAcknowledgeInvalidToken</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusNotFound</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckGetEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">invalidJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusForbidden</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgePostFound</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>rule has been acked before, 2nd call to aggregator happens in any case</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule_id&#34;: &#34;%v&#34;,
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">expectedResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule&#34;: &#34;%v&#34;,
		&#34;justification&#34;: &#34;%v&#34;,
		&#34;created_by&#34;: &#34;&#34;,
		&#34;created_at&#34;: &#34;%v&#34;,
		&#34;updated_at&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">expectedResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">expectedResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckAcknowledgePostEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">expectedResponse</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgePostNewAck</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">emptyAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>1st call to aggregator to find out whether rule has been acked already or not</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusNotFound</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">emptyAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">putBody</div> <div class="operator">:=</div> <div class="literal">`{&#34;justification&#34;:&#34;%v&#34;}`</div><div class="operator"></div>
	<div class="ident">putBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">putBody</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>PUT to aggregator</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">DisableRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>         <div class="ident">putBody</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>2nd call to aggregator to confirm data entered DB</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule_id&#34;: &#34;%v&#34;,
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">expectedResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule&#34;: &#34;%v&#34;,
		&#34;justification&#34;: &#34;%v&#34;,
		&#34;created_by&#34;: &#34;&#34;,
		&#34;created_at&#34;: &#34;%v&#34;,
		&#34;updated_at&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">expectedResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">expectedResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckAcknowledgePostEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>201 CREATED when rule wasn't acked before</p>
</td>
	<td class="code"><pre><code>		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusCreated</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">expectedResponse</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgePostMissingParam</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>missing rule_id</p>
</td>
	<td class="code"><pre><code>	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckAcknowledgePostEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusBadRequest</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgePostBadCompositeRuleID</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule_id&#34;: &#34;invalid rule id&#34;
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckAcknowledgePostEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusBadRequest</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgePostAggregatorError1stCall</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule_id&#34;: &#34;%v&#34;,
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckAcknowledgePostEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgePostAggregatorError2ndCall</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">emptyAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>2nd call fails</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">emptyAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule_id&#34;: &#34;%v&#34;,
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckAcknowledgePostEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgePostInvalidToken</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule_id&#34;: &#34;%v&#34;,
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="literal">&#34;justification&#34;</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckAcknowledgePostEndpoint</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">invalidJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusForbidden</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeUpdateNotFound</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">emptyAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>1st call to aggregator to find out whether rule has been acked already or not</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>existing ack not found</p>
</td>
	<td class="code"><pre><code>			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusNotFound</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">emptyAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckUpdateEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusNotFound</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeUpdateFound</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>
	<div class="ident">justificationUpdated</div> <div class="operator">:=</div> <div class="literal">&#34;justification updated&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">postBody</div> <div class="operator">:=</div> <div class="literal">`{&#34;justification&#34;:&#34;%v&#34;}`</div><div class="operator"></div>
	<div class="ident">postBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">postBody</div><div class="operator">,</div> <div class="ident">justificationUpdated</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>POST to aggregator</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">UpdateRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>         <div class="ident">postBody</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponseUpdated</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponseUpdated</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponseUpdated</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationUpdated</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>2nd call to aggregator to get results</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponseUpdated</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">justificationUpdated</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">expectedResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;rule&#34;: &#34;%v&#34;,
		&#34;justification&#34;: &#34;%v&#34;,
		&#34;created_by&#34;: &#34;&#34;,
		&#34;created_at&#34;: &#34;%v&#34;,
		&#34;updated_at&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">expectedResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">expectedResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">,</div> <div class="ident">justificationUpdated</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckUpdateEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">expectedResponse</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeUpdateBadCompositeRuleID</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckUpdateEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="literal">&#34;invalid rule id&#34;</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusBadRequest</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeUpdateAggregatorError1st</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">justificationUpdated</div> <div class="operator">:=</div> <div class="literal">&#34;justification updated&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">justificationUpdated</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckUpdateEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeUpdateAggregatorError2nd</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>
	<div class="ident">justificationUpdated</div> <div class="operator">:=</div> <div class="literal">&#34;justification updated&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">postBody</div> <div class="operator">:=</div> <div class="literal">`{&#34;justification&#34;:&#34;%v&#34;}`</div><div class="operator"></div>
	<div class="ident">postBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">postBody</div><div class="operator">,</div> <div class="ident">justificationUpdated</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>POST to aggregator</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">UpdateRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>         <div class="ident">postBody</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">justificationUpdated</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckUpdateEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeUpdateAggregatorError3rd</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>
	<div class="ident">justificationUpdated</div> <div class="operator">:=</div> <div class="literal">&#34;justification updated&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">postBody</div> <div class="operator">:=</div> <div class="literal">`{&#34;justification&#34;:&#34;%v&#34;}`</div><div class="operator"></div>
	<div class="ident">postBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">postBody</div><div class="operator">,</div> <div class="ident">justificationUpdated</div><div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>POST to aggregator</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPost</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">UpdateRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>         <div class="ident">postBody</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>2nd call to aggregator to get results fails</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="ident">justificationUpdated</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckUpdateEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeUpdateInvalidToken</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="literal">&#34;justification&#34;</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckUpdateEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">invalidJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusForbidden</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeDeleteFound</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>PUT to aggregator</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">EnableRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodDelete</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckDeleteEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusNoContent</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeDeleteNotFound</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusNotFound</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodDelete</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckDeleteEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusNotFound</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeDeleteBadRequest</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodDelete</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckDeleteEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="literal">&#34;invalid rule id&#34;</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusBadRequest</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeDeleteInvalidToken</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">reqBody</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;justification&#34;: &#34;%v&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">reqBody</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">reqBody</div><div class="operator">,</div> <div class="literal">&#34;justification&#34;</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodDelete</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckDeleteEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">invalidJWTAuthBearer</div><div class="operator">,</div>
		<div class="ident">Body</div><div class="operator">:</div>               <div class="ident">reqBody</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusForbidden</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeDeleteAggregatorError1st</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodDelete</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckDeleteEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

<div class="keyword">func</div> <div class="ident">TestHTTPServer_TestAcknowledgeDeleteAggregatorError2nd</div><div class="operator">(</div><div class="ident">t</div> <div class="operator">*</div><div class="ident">testing</div><div class="operator">.</div><div class="ident">T</div><div class="operator">)</div> <div class="operator">{</div>
	<div class="keyword">defer</div> <div class="ident">helpers</div><div class="operator">.</div><div class="ident">CleanAfterGock</div><div class="operator">(</div><div class="ident">t</div><div class="operator">)</div><div class="operator"></div>
	<div class="keyword">defer</div> <div class="ident">content</div><div class="operator">.</div><div class="ident">ResetContent</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">disabledAt</div> <div class="operator">:=</div> <div class="ident">time</div><div class="operator">.</div><div class="ident">Now</div><div class="operator">(</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">disabledAtRFC</div> <div class="operator">:=</div> <div class="ident">disabledAt</div><div class="operator">.</div><div class="ident">UTC</div><div class="operator">(</div><div class="operator">)</div><div class="operator">.</div><div class="ident">Format</div><div class="operator">(</div><div class="ident">time</div><div class="operator">.</div><div class="ident">RFC3339</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">justificationNote</div> <div class="operator">:=</div> <div class="literal">&#34;justification test&#34;</div><div class="operator"></div>

	<div class="ident">err</div> <div class="operator">:=</div> <div class="ident">loadMockRuleContentDir</div><div class="operator">(</div><div class="operator">&amp;</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">RuleContentDirectory3Rules</div><div class="operator">)</div><div class="operator"></div>
	<div class="ident">assert</div><div class="operator">.</div><div class="ident">Nil</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">err</div><div class="operator">)</div><div class="operator"></div>

	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">:=</div> <div class="literal">`
	{
		&#34;disabledRule&#34;:{
			&#34;rule_id&#34;: &#34;%v&#34;,
			&#34;error_key&#34;: &#34;%v&#34;,
			&#34;justification&#34;: &#34;%v&#34;,
			&#34;created_by&#34;: &#34;&#34;,
			&#34;created_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			},
			&#34;updated_at&#34;: {
				&#34;Time&#34;: &#34;%v&#34;,
				&#34;Valid&#34;: true
			}
		},
		&#34;status&#34;:&#34;ok&#34;
	}
	`</div><div class="operator"></div>
	<div class="ident">ackedRuleAggregatorResponse</div> <div class="operator">=</div> <div class="ident">fmt</div><div class="operator">.</div><div class="ident">Sprintf</div><div class="operator">(</div><div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">justificationNote</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div> <div class="ident">disabledAtRFC</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodGet</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">ReadRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusOK</div><div class="operator">,</div>
			<div class="ident">Body</div><div class="operator">:</div>       <div class="ident">ackedRuleAggregatorResponse</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
      <tr class="section">
	<td class="doc"><p>PUT to aggregator</p>
</td>
	<td class="code"><pre><code>	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">GockExpectAPIRequest</div><div class="operator">(</div>
		<div class="ident">t</div><div class="operator">,</div>
		<div class="ident">helpers</div><div class="operator">.</div><div class="ident">DefaultServicesConfig</div><div class="operator">.</div><div class="ident">AggregatorBaseEndpoint</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
			<div class="ident">Method</div><div class="operator">:</div>       <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodPut</div><div class="operator">,</div>
			<div class="ident">Endpoint</div><div class="operator">:</div>     <div class="ident">ira_server</div><div class="operator">.</div><div class="ident">EnableRuleSystemWide</div><div class="operator">,</div>
			<div class="ident">EndpointArgs</div><div class="operator">:</div> <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1ID</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">ErrorKey1</div><div class="operator">,</div> <div class="ident">testdata</div><div class="operator">.</div><div class="ident">OrgID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
		<div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
			<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
		<div class="operator">}</div><div class="operator">,</div>
	<div class="operator">)</div><div class="operator"></div>

	<div class="ident">helpers</div><div class="operator">.</div><div class="ident">AssertAPIv2Request</div><div class="operator">(</div><div class="ident">t</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="ident">nil</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIRequest</div><div class="operator">{</div>
		<div class="ident">Method</div><div class="operator">:</div>             <div class="ident">http</div><div class="operator">.</div><div class="ident">MethodDelete</div><div class="operator">,</div>
		<div class="ident">Endpoint</div><div class="operator">:</div>           <div class="ident">server</div><div class="operator">.</div><div class="ident">AckDeleteEndpoint</div><div class="operator">,</div>
		<div class="ident">EndpointArgs</div><div class="operator">:</div>       <div class="operator">[</div><div class="operator">]</div><div class="keyword">interface</div><div class="operator">{</div><div class="operator">}</div><div class="operator">{</div><div class="ident">testdata</div><div class="operator">.</div><div class="ident">Rule1CompositeID</div><div class="operator">}</div><div class="operator">,</div>
		<div class="ident">AuthorizationToken</div><div class="operator">:</div> <div class="ident">goodJWTAuthBearer</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">,</div> <div class="operator">&amp;</div><div class="ident">helpers</div><div class="operator">.</div><div class="ident">APIResponse</div><div class="operator">{</div>
		<div class="ident">StatusCode</div><div class="operator">:</div> <div class="ident">http</div><div class="operator">.</div><div class="ident">StatusInternalServerError</div><div class="operator">,</div>
	<div class="operator">}</div><div class="operator">)</div><div class="operator"></div>
<div class="operator">}</div><div class="operator"></div>

</code></pre></td>
      </tr>
      
    </tbody>
  </table>
</div>
</body>
</html>
